@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>ID-CARD</title>
    <link href="../assets/css/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/sweetalert.css" rel="stylesheet" />
    <link href="../assets/css/stylesearch.css" rel="stylesheet" />
    <link href="../assets/css/stylehome.css" rel="stylesheet" />
    <script src="../assets/dataTable/dataTables/jquery-3.5.1.js"></script>
    <script src="../assets/js/jquery-ui/jquery-ui.min.js"></script>
    <script src="../assets/dataTable/dataTables/jquery.dataTables.min.js"></script>
    <script src="../assets/js/popperjs/popper.min.js"></script>
    @*<script src="../assets/js/moment-with-locales.min.js"></script>*@
    <script src="../assets/js/bootstrap/js/bootstrap.min.js"></script>
    <script src="../scripts/sweetalert.min.js"></script>
    <link href="../assets/css/all.css" rel="stylesheet" />
    <link href="../assets/css/stylereport.css" rel="stylesheet" />
    <link href="../assets/dataTable/dataTables/buttons.dataTables.min.css" rel="stylesheet" />
    <link href="../assets/dataTable/dataTables/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="../assets/dataTable/dataTables/buttons.dataTables.min.css" rel="stylesheet" />
    <script src="../assets/dataTable/dataTables/dataTables.buttons.min.js"></script>
    <script src="../assets/dataTable/dataTables/buttons.html5.min.js"></script>
    <script src="../assets/dataTable/dataTables/jszip.min.js"></script>
    <script src="../assets/dataTable/dataTables/pdfmake.min.js"></script>
    <script src="../assets/dataTable/dataTables/vfs_fonts.js"></script>
    <script src="../assets/dataTable/dataTables/buttons.print.min.js"></script>



    <!--<link rel="stylesheet" href="~/assets/css/stylepayment.css">
    <link href="~/assets/css/jquery-ui.css" rel="stylesheet" />
    <script src="~/Content/assets/js/libs/jquery/jspdf.js"></script>-->
    @*<script src="~/scripts/html2canvas.js"></script>*@

    <style>
        #cover {
            /*background: url("to/your/ajaxloader.gif") no-repeat scroll center center #FFF;*/
            background-color: rgba(33,63,113, 0.6);
            position: fixed;
            top: 0px;
            bottom: 0px;
            height: 100%;
            width: 100%;
            z-index: 100000;
        }

            #cover i {
                /*background: url("to/your/ajaxloader.gif") no-repeat scroll center center #FFF;*/
                margin-left: 50%;
                margin-top: 50vh;
            }

        .btn:disabled {
            opacity: 0.2 !important;
        }

        .card-counter {
            box-shadow: 4px 4px 2px -1px rgba(0,0,0,0.4);
            margin: 5px;
            padding: 10px 10px;
            background-color: #fff;
            height: 75px;
            border-radius: 5px;
            transition: .3s linear all;
            border: 1px solid rgba(0, 0, 0, 0.125);
        }

            .card-counter:hover {
                box-shadow: 4px 4px 20px #DADADA;
                transition: .3s linear all;
            }

            .card-counter.primary {
                /*background-color: #007bff;*/
                background: linear-gradient(to top,#30cfd0 0,#330867 100%) !important;
                background: -webkit-gradient(linear-gradient(to top,#30cfd0 0,#330867 100%)) !important;
                color: #FFF;
            }

            .card-counter.danger {
                background-color: #ef5350;
                color: #FFF;
            }

            .card-counter.success {
                background-color: #66bb6a;
                color: #FFF;
            }

            .card-counter.info {
                background: linear-gradient(to right, #667eea, #764ba2) !important;
                background: -webkit-gradient(linear-gradient(to right, #667eea, #764ba2)) !important;
                color: #FFF;
            }

            .card-counter i {
                font-size: 3.5em;
                opacity: 0.5;
                margin-top: -1px;
            }

            .card-counter .fa.fa-spinner {
                font-size: 1.5em !important;
                opacity: 0.5;
            }

            .card-counter .count-numbers {
                position: absolute;
                right: 30px;
                top: 10px;
                font-size: 28px;
                display: block;
                /*font-weight:800;*/
                text-shadow: 10px 10px 0px 0px #333;
            }

            .card-counter .count-name {
                position: absolute;
                right: 30px;
                top: 55px;
                font-style: italic;
                text-transform: capitalize;
                opacity: 0.8;
                display: block;
                font-size: 12px;
                /*font-weight: 700;*/
            }

        .cus-top-cards {
            border: 1px solid #ccc;
            padding: 0.8rem;
            box-shadow: inset 0px 1px 8px 2px #a9a9a9;
        }

        .table td, .table th {
            padding: 0.8rem !important;
            font-size: 13px !important;
        }

        .cus-printbtn {
            background: #E91E63;
            cursor: pointer;
            border: 1px solid #E91E63;
            background-image: none;
            color: #fff;
            font-style: normal;
        }

            .cus-printbtn:hover {
                background: #E91E63;
                transition: all 0.5s;
                border-radius: 10px;
                box-shadow: 0px 6px 10px #e91e63;
                color: #fff;
            }

        .cus-printbtn1 {
            background: #201dd5;
            cursor: pointer;
            border: 1px solid #201dd5;
            background-image: none;
            color: #fff;
            font-style: normal;
        }

            .cus-printbtn1:hover {
                background: #201dd5;
                transition: all 0.5s;
                border-radius: 10px;
                box-shadow: 0px 6px 10px #201dd5;
                color: #fff;
            }
    </style>

    <style type="text/css">
        .modalBackground {
            background-color: rgb(192,234,255);
            filter: alpha(opacity=70);
            opacity: 0.7;
            z-index: 100 !important;
        }

        .modalPopup {
            background-color: #ffffff;
            border-width: 3px;
            border-style: solid;
            border-color: Gray;
            padding: 3px;
            /*width: 250px;*/
            z-index: 100;
        }

        .btnPop {
            background-color: #033280;
            color: White;
            font-size: 12px;
            font-weight: bold;
            padding-left: 5px;
        }
    </style>

    <style>
        body {
            margin: 0;
        }

        table,
        tr,
        td {
            word-wrap: break-word;
            border: 0px solid #fff;
            vertical-align: top;
        }

        section {
            width: 1150px;
            margin: 0 auto;
        }

        .wrapper {
            width: 550px;
            min-height: 300px;
            position: relative;
            border: 2px solid #333;
            /*border-left: 40px solid #2F308A;*/
            padding: 15px;
            font-size: small;
            display: inline-block;
        }

        .wrapper1 {
            width: 550px;
            min-height: 300px;
            position: relative;
            border: 2px solid #333;
            padding: 10px;
            color: rgba(black, 0.5);
            font-size: small;
            display: inline-block;
            height: 300px;
        }

        /* .wrapper h5 {
                    font-size: 12px;
                    color: white;
                    text-transform: uppercase;
                    margin: 0 auto;
                    position: absolute;
                    bottom: 25px;
                    left: -30px;
                    transform: rotate(270deg);
                    transform-origin: 0 0;
                    word-wrap: break-word;
                }
        */
        div.dt-buttons button.dt-button:last-child {
            float: right;
            background: no-repeat;
            border: none;
        }

        div.dt-buttons {
            position: relative;
            float: left;
            width: 100%;
            display: inline-block;
        }
    </style>




</head>

<body>
    <div id="cover">
        <i class="fa fa-spinner fa-spin" style="font-size:xx-large"></i>
    </div>
    <div class="container-fluid">
        <div class="row main-banner">
            <img src="../assets/images/banner.jpg" style="width: 100%" alt="online admission portal" />
        </div>

    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-1 col-md-1 col-sm-1 col-2"></div>
            <div class="col-lg-10 col-md-10 col-sm-10 col-8 text-center top-heading" style="margin-top: 5px;"><h4 class="heading hedderstle">Students Id Card</h4></div>
            <div class="col-lg-1 col-md-1 col-sm-1 col-1 text-right back-btn" style="margin-top: 10px;">
                <a href="~/DHE/HEMenu.aspx" id="btnBack" class="btn btn-icon icon-left btn-primary"><i class="fas fa-arrow-alt-circle-left"></i></a>
            </div>
        </div>
    </div>

    <div class="container-fluid" id="main">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-12" style="margin-top: 20px;margin-bottom: 20px;">
                <div class="cus-top-section">



                    <div class="col-lg-2 col-md-2 col-sm-4 col-12">
                        <label for="ddlCollege">Select College <span class="" style="color:red;"></span></label>

                        <select id="ddlCollege" class="form-control custom-select">
                            @if (Session["collegeId"] != null)
                            {
                                if (Session["collegeId"].ToString() == "0")
                                {
                                    <option value="0">Select All</option>
                                }
                                else
                                {
                                    <option value="">Please select College</option>
                                }
                            }


                        </select>
                    </div>
                    <div class="col-lg-2 col-md-2 col-sm-4 col-12">

                        <label for="ddlCourse">Select Course <span class="" style="color:red;"></span></label>
                        <select id="ddlCourse" class="form-control custom-select">
                            <option value="0">Select All</option>
                        </select>
                    </div>
                    <div class="col-lg-2 col-md-2 col-sm-4 col-12">

                        <label for="ddlSection">Select Section <span class="" style="color:red;"></span></label>
                        <select id="ddlSection" class="form-control custom-select">
                            <option value="0">Select All</option>
                        </select>
                    </div>
                    <div class="col-lg-2 col-md-2 col-sm-4 col-12 cus-getbtn">
                        <label style="margin-top:17px;"></label><br />
                        <button class="btn btn-primary" onclick="getData(); return false;">Search</button>
                        @*@if (Session["collegeId"] != null && Session["collegeId"].ToString() == "0")
                            {
                                <button class="btn btn-primary" onclick="getData(1); return false;">Search Duplicates</button>
                            }*@

                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-12 col-md-12 col-sm-12 col-12 cus-grid-table-down" style="margin-bottom: 0px" ;>
            @*<div class="bg-white rounded shadow mb-5">*@
            <div id="myTab2Content" class="tab-content">
                <div id="tab1" role="tabpanel" aria-labelledby="aioc" class="tab-pane fade py-3 show active">
                    <div class="table-responsive">

                        <table class="table table-striped table-bordered table-hover" id="TotalSummary">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                            <tfoot>
                                <tr>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                </tr>
                            </tfoot>
                        </table>

                    </div>
                </div>
            </div>
            @*</div>*@
        </div>
        @*OMGOMG*@
        <div class="partialContent"></div>
        <!-- Modal -->
        <div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title cus-heading" id="exampleModalLabel">Student Fee Receipt</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" id="mydatamodel2">

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

                    </div>
                </div>
            </div>
        </div>
    </div>




    <div id="Preview" class="container-fluid" style="margin-top:10px">
        <div class="col-lg-12 col-md-12 col-sm-12 col-12 cus-merit-table" style="padding: 0; ">
            <div class="col-lg-12" style="box-shadow: 0px 0px 4px 0px; background: #ebe9e9; padding: 0.6rem 0.5rem; display: flex; justify-content: center; height: 35px; ">
                <h5 style="font-size:16px;">Preview Identity Cards</h5>
            </div>
            <div class="col-lg-12" style="display: flex; justify-content: right; margin-top: 20px; margin-bottom: 20px; ">
                <button class="btn cus-printbtn1" id="printIDCard" onclick="PrintIDs();">Print</button>
            </div>
            <div class="col-lg-12 col-md-12 col-sm-12 col-12 cus-grid-table-down" id="PrintReceiptDiv" style="box-shadow:inset 0px 0px 10px 0px;">
            </div>
        </div>
    </div>

    @* <div class="container-fluid" id="PrintReceiptDiv" style="margin:auto;bottom:10px;">

        </div>*@

    <!-- ======= Footer ======= -->
    <footer id="footer" style="position:relative;">

        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-12 text-center">
                    <div class="row">
                        <div class="col-lg-10 col-md-10 text-left" style="margin-top:10px;">
                            <div class="credits">
                                <a>Site is technically designed, hosted and maintained by National Informatics Centre, Haryana</a>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-2">
                            <img src="../assets/images/nic-logo.png" style="width:100px;">
                        </div>
                    </div>
                </div>

            </div>

        </div>

    </footer>
    <!-- End Footer -->
</body>
</html>
<script>
function PrintElem(elem) {
    Popup($('<div/>').append($(elem).clone()).html());
}

function Popup(data) {
    var mywindow = window.open('', 'my_div', 'height=400,width=600');
    mywindow.document.write('<html><head><title>my div</title>');
    mywindow.document.write(` <link href="../assets/css/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
            <link href="../assets/css/sweetalert.css" rel="stylesheet" />
            <link href="../assets/css/stylesearch.css" rel="stylesheet" />
            <link href="../assets/css/stylehome.css" rel="stylesheet" />
            <link href="../assets/css/all.css" rel="stylesheet" />
            <link href="../assets/css/stylereport.css" rel="stylesheet" />
            <link href="../assets/dataTable/dataTables/buttons.dataTables.min.css" rel="stylesheet" />
            <link href="../assets/dataTable/dataTables/jquery.dataTables.min.css" rel="stylesheet" />
            <link href="../assets/dataTable/dataTables/buttons.dataTables.min.css" rel="stylesheet" />`);
    mywindow.document.write('</head><body>');
    mywindow.document.write(data);
    mywindow.document.write('</body></html>');
    mywindow.print();
    //  mywindow.close();

    return true;
}

var errorFn = function(jqXHR, exception) {
    var msg = '';
    if (jqXHR.status === 0) {
        msg = 'Not connect.\n Verify Network.';
    } else if (jqXHR.status == 404) {
        msg = 'Requested page not found. [404]';
    } else if (jqXHR.status == 500) {
        msg = 'Internal Server Error [500].';
    } else if (exception === 'parsererror') {
        msg = 'Requested JSON parse failed.';
    } else if (exception === 'timeout') {
        msg = 'Time out error.';
    } else if (exception === 'abort') {
        msg = 'Ajax request aborted.';
    } else {
        msg = 'Uncaught Error.\n' + jqXHR.responseText;
    }
    alert("Error: " + msg);
}

function nWin() {
    var w = window.open();
    var html = $(".partialContent").html();

    $(w.document.body).html(html);
}

$(function() {
    $("a#print").click(nWin);
});

var url_1 = '@Url.Action("d_getCollegeType", "Reports")'; //to fetch college type
function getCollegeType() {
    $("#cover").fadeIn();
    $.ajax({
        url: url_1,
        type: 'GET',
        contentType: 'application/json;charset=utf-8',
        dataType: 'json',
        success: function(data) {
            var TypeOfCollege = JSON.parse(data);
            $("#ddlCollegeType").empty();
            if (C_ID == '0') {
                $("#ddlCollegeType").append('<option value="0">Select All</option>');
            } else {
                $("#ddlCollegeType").append('<option value="">Please select college Type</option>');
            }
            $.each(TypeOfCollege, function(i) {
                $("#ddlCollegeType").append(`<option value='` + TypeOfCollege[i].collegetypeid + `'>` + TypeOfCollege[i].collegetype + `</option>`);
            });

            if (test != 'dhepkl' && test != '') {
                $("#ddlCollegeType").val(C_ID);
                $("#ddlCollegeType").change();
            }
            $("#cover").fadeOut();
        },
        error: errorFn
    });
}


function printContent(el)
{
    //debugger

    var restorepage = document.body.innerHTML;
    var printcontentt = document.getElementById(el).innerHTML;
    if (printcontentt != '') {
        document.body.innerHTML =printcontentt;
        window.print();
        document.body.innerHTML = restorepage;
        var url = '@Url.Action("IDCardReport", "Reports")';
        window.location.href = url;
    }
    else {
        swal('Alert!', 'Please select I-Card(s) to Print ', 'error'); return;
    }
};
    var currpage = 0;
    $(document).ready(function () {
     //debugger
     $('#Preview').hide();
        $("#cover").hide();

        if (C_ID != '0') {
        getCollegeList1();
        $("#ddlCollege").prop("disabled", true);

    }
    else {
        getCollegeList();
    }
    /* });*/
    $(document).on('hide.bs.modal', '#myModal2', function() {
        $("#PrintReceiptDiv").hide();

    });
    $(document).on('show.bs.modal', '#myModal2', function() {
        $("#PrintReceiptDiv").show();

    });


    $("#ddlCollege").on('change', function() {
        $("#ddlSection").empty();
        $("#ddlSection").append(`<option value='0'>Select All</option>`);
        getCourseListArPerCollege($(this).val());
        checkID = [];
    });

    $("#ddlCourse").on('change', function () {
        $('#Preview').hide();
        $("#ddlSection").empty();
        $("#ddlSection").append(`<option value='0'>Select All</option>`);
        getSectionListAsPerCourse($('#ddlCollege').val(), $(this).val());
        getData();
        checkID = [];
    });

    $("#ddlSection").on('change', function () {
        getData();
        checkID = [];
    });

});

    var url6 = '@Url.Action("GetCollegeList", "Reports")';
   function getCollegeList1() {
    $.ajax({
        url: url6,
        type: 'GET',
        contentType: 'application/json;charset=utf-8',
        dataType: 'json',
        success: function(data) {
            var ListOfColleges = JSON.parse(data);
            $("#ddlCollege").empty();
            $("#ddlCollege").append(`<option value=''>Please select college</option>`);
            $.each(ListOfColleges, function(i) {
                $("#ddlCollege").append(`<option value='` + ListOfColleges[i].collegeid + `'>` + ListOfColleges[i].collegename + `</option>`);
            });
            if (C_ID != '0' && test != '') {
                //getData();
                        $("#ddlCollege").val(C_ID);
                        $("#ddlCollege").change();
                    }
        },
        error: errorFn
    });
}
var url1 = '@Url.Action("GetSectionList", "Reports")';

function getSectionListAsPerCourse(collegeId,courseId) {
    var dataToSend = {};
    dataToSend.CollegeId = collegeId;
    dataToSend.CourseId = courseId;
    $.ajax({
        url: url1,
        type: 'POST',
        contentType: 'application/json;charset=utf-8',
        dataType: 'json',
        data: JSON.stringify(dataToSend),
        success: function(data) {
            var ListOfSections = JSON.parse(data);
            $("#ddlSection").empty();
            $("#ddlSection").append(`<option value='0'>Select All</option>`);
            $.each(ListOfSections.Table, function(i) {
                $("#ddlSection").append(`<option value='` + ListOfSections.Table[i].SectionId + `'>` + ListOfSections.Table[i].sectionName + `</option>`);
            })
        },
        error: errorFn
    })
}

var url2 = '@Url.Action("GetCollegeList", "Reports")';
var test = '@Session["UserId"]';
var C_ID = '@Session["collegeId"]';

    function getCollegeList() {
        //debugger
    $("#cover").fadeIn();
        $.ajax({
            url: url2,
            type: 'GET',
            contentType: 'application/json;charset=utf-8',
            data: {},
        dataType: 'json',
        success: function(data) {
            var ListOfColleges = JSON.parse(data);
            $("#ddlCollege").empty();

            if (C_ID == '0') {
                $("#ddlCollege").append('<option value="0">Select All</option>');
            } else {
                $("#ddlCollege").append('<option value="">Please select college</option>');
            }


            $.each(ListOfColleges, function(i) {
                $("#ddlCollege").append(`<option value='` + ListOfColleges[i].collegeid + `'>` + ListOfColleges[i].collegename + `</option>`);
            });

            if (C_ID != '0' && test != '') {
                $("#ddlCollege").val(C_ID);
                $("#ddlCollege").change();
            }
            $("#cover").fadeOut();
        },
        error: errorFn
    });
}

var url3 = '@Url.Action("GetCourseList", "Reports")';

function getCourseListArPerCollege(collegeId) {
    $("#cover").fadeIn();
    var dataToSend = {};
    dataToSend.collegeId = $("#ddlCollege").val();
    $.ajax({
        url: url3,
        type: 'get',
        contentType: 'application/json;charset=utf-8',
        dataType: 'json',
        data: dataToSend,
        success: function(data) {
            var ListOfCourses = JSON.parse(data);
            $("#ddlCourse").empty();
            $("#ddlCourse").append(`<option value='0'>Select All</option>`);
            $.each(ListOfCourses, function(i) {
                $("#ddlCourse").append(`<option value='` + ListOfCourses[i].courseid + `'>` + ListOfCourses[i].name + `</option>`);
            })
            $("#cover").fadeOut();
        },
        error: errorFn

    })
}

var url4 = '@Url.Action("d_getIdCard", "Reports")';

var TotalIdCards = 0;
async function fetchIdCard(regid)
{
    var dataToSend = {};
    dataToSend.RegId = regid;
    $.ajax({
        url: url4,
        type: 'get',
        //type: 'POST',
        contentType: 'application/json;charset=utf-8',
        dataType: 'html',
        data: dataToSend,
        success: function (data) {
            //debugger
            TotalIdCards++;
            if (TotalIdCards % 5 == 0)
            {
                $("#PrintReceiptDiv").html($("#PrintReceiptDiv").html() + data + '<div style="page-break-after: always;"></div>');
            }
            else
            {
                $("#PrintReceiptDiv").html($("#PrintReceiptDiv").html() + data);
            }

        },
        error: errorFn
    })
}


function PrintIDs()
{
    alert("Please set margins to none before printing cards.");
    printContent("PrintReceiptDiv");
    $("#PrintReceiptDiv").html('');
    
}

var CollegeNameSelected;
var SectionNameSelected;
var url5 = '@Url.Action("d_getStudentDetails", "Reports")';
    var CompleteDataSet = '';
    var urlError = '@Url.Action("Error", "Account")';
    function getData() {
        if ($("#ddlCollege").val() == '' || $("#ddlCollege").val() == '0' || $("#ddlCollege").val() == 'null') {
            swal('Alert!', 'Please Select College ', 'error'); return;
        }
        /*
        if ($("#ddlCourse").val() == '' || $("#ddlCourse").val() == '0') {
            swal('Alert!', 'Please Select Course ', 'error'); return;
        }*/
    $("#cover").fadeIn();
    var dataToSend = {};
    dataToSend.CollegeId = $("#ddlCollege").val();
    dataToSend.CourseId = $("#ddlCourse").val();
    dataToSend.SectionId = $("#ddlSection").val();
    if ($("#ddlCollege :selected").text() == 'Select All')
    {
        CollegeNameSelected = 'All College';
    }
    else
    {
        CollegeNameSelected = $("#ddlCollege :selected").text();
    }

    SectionNameSelected = $("#ddlSection :selected").text();
    SectionNameSelected = $("#ddlSection :selected").text();

    $.ajax({
        url: url5,
        type: 'POST',
        contentType: 'application/json;charset=utf-8',
        dataType: 'json',
        data: JSON.stringify(dataToSend),
        success: function(data) {
            if (data == "1") {

                window.location.replace(urlError);
                return false;
            }
            CompleteDataSet = JSON.parse(data);

            var exOptn = {
                stripHtml: true,
                columns: ':visible',
            };
            var buttonsArray = [{
                    text: '<i class="fa fa-file-pdf" style="color:RED;"></i>',
                    extend: 'pdfHtml5',
                    footer: true,
                    title: 'Students Report',
                    messageTop: CollegeNameSelected,
                    messageBottom: '',
                    pageSize: 'A4',
                    orientation: 'landscape',
                    exportOptions: {
                    columns: [0,1, 2,3, 4,5,6,7,8,9],
                },
                },
                {
                    text: '<i class="fa fa-file-excel" style="color:GREEN;"></i>',
                    extend: 'excelHtml5',
                    exportOptions: exOptn,
                    title: 'Students Report',
                    pageSize: 'A4',
                    messageTop: CollegeNameSelected,
                    exportOptions: {
                        columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
                    }
                },
                {
                    text: '<i class="fa fa-file-csv" style="color:BLUE;"></i>',
                    extend: 'csvHtml5',
                    title: 'Students Report',
                    pageSize: 'A4',
                    exportOptions: {
                        columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
                    }
                },
                {
                    text: '<i class="fa fa-print" style="color:Black;"></i>',
                    extend: 'print',
                    pageSize: 'A4',
                    exportOptions: {
                        columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
                    },
                    title: 'Students Report',
                },
                {
                    text: '<i  class="btn cus-printbtn" id="save_value" onclick="preView();">Preview I-Cards</i>',
                    //text: '<i  class="btn cus-printbtn" id="save_value" onclick="redTest();">Redirect</i>',
                },
            ];
            var columnsArray = [
                { data: null, title: 'Sno', render: function (data, type, row, meta) { return meta.row + meta.settings._iDisplayStart + 1; } },
                { data: "registrationID", title: "Registration No",},
                { data: "CandidateName", title: "Student Name", },
                { data: "FatherName", title: "Father's Name", },
                { data: "MotherName", title: "Mother's Name", },
                { data: "Gender", title: "Gender", },
                { data: "BirthDate", title: "Date Of Birth", },
                { data: "CandidateName", title: "Merit Percentage", visible: false },
                { data: "MobileNo", title: "Mobile Number", },
                { data: "TradeName", title: "Course", },
                { data: 'registrationID', title: '<input type="checkbox" id="select_All_Cards" name="selectAll" onclick="selectAll();"> Select All', render: (d, t, r) => { return '<input type="checkbox" class="check_invoice" id="' + d + '" name="check_123" value="' + d + '" onchange="handleChange(this);"/>'; }}
            ];
            $("#TotalSummary").DataTable({
                data: CompleteDataSet.Table,
                dom: 'Blfrtip',
                buttons: buttonsArray,
                paging: true,
                pageLength: 10,
                lengthMenu: [
                    [10, 25, 50, 100, -1],
                    [10, 25, 50, 100, 'All'],
                ],
                destroy: true,
                pageSize: 'A4',
                "bFilter": false,
                //bPaginate: true,
                //"order": [[1, "asc"]],
                columns: columnsArray,
                columnDefs: [
                    { orderable: false, targets: -1 }
                ],
                "drawCallback": function (settings) {
                    $('input[name="selectAll"]').prop('checked', false);
                    //$('input[name="check_123"]').prop('checked', false);
                    //$('#PrintReceiptDiv').html('');
                    //$('#Preview').hide();
                },
            });
            $("#cover").fadeOut();
        },
        error: errorFn
    })
        }


    var checkID = [];

    function handleChange(checkbox) {

        $("#PrintReceiptDiv").html('');
        $('#Preview').hide();
        if ($(".check_invoice").length == $(".check_invoice:checked").length) {
            $("#select_All_Cards").prop("checked", true);
        } else {
            $("#select_All_Cards").prop("checked", false);
        }
        if (checkbox.checked == true) {
            const index = checkID.indexOf(checkbox.id);
            if (index > -1) { // only splice array when item is found
                checkID.splice(index, 1); // 2nd parameter means remove one item only
            }
            checkID.push(checkbox.id);
        }
        else {
            const index = checkID.indexOf(checkbox.id);
            if (index > -1) { // only splice array when item is found
                checkID.splice(index, 1); // 2nd parameter means remove one item only
            }
        }
    }




    function selectAll() {

        $("#PrintReceiptDiv").html('');
        $('#Preview').hide();
        var blnChecked = document.getElementById("select_All_Cards").checked;
        var check_invoices = document.getElementsByClassName("check_invoice");
        var intLength = check_invoices.length;
        if (blnChecked == true) {
            for (var i = 0; i < intLength; i++) {
                //var check_invoice = check_invoices[i];
                check_invoices[i].checked = blnChecked;
                const index = checkID.indexOf(check_invoices[i].id);
                if (index > -1) { // only splice array when item is found
                    checkID.splice(index, 1); // 2nd parameter means remove one item only
                }
                checkID.push(check_invoices[i].id);
            }
        }
        else {
            for (var i = 0; i < intLength; i++) {
                check_invoices[i].checked = blnChecked;
                const index = checkID.indexOf(check_invoices[i].id);
                if (index > -1) { // only splice array when item is found
                    checkID.splice(index, 1); // 2nd parameter means remove one item only
                }
            }
        }
    }

    function preView() {
        $("#btnBack").attr("href", "IDCardReport")
        var intLength = checkID.length;
        if (intLength > 0) {
            $("#cover").fadeIn();
            $("#PrintReceiptDiv").html('');
            $('#Preview').show();
            $('#main').hide();

            for (var i = 0; i < intLength; i++) {
                fetchIdCard(checkID[i])
            }
            if (intLength > 0 && intLength <= 10)
                $("#cover").fadeOut(5000);
            else if (intLength > 10 && intLength <= 50)
                $("#cover").fadeOut(15000);
            else if (intLength > 50 && intLength <= 80)
                $("#cover").fadeOut(20000);
            else if (intLength > 80 && intLength <= 120)
                $("#cover").fadeOut(25000);
            else if (intLength > 120 && intLength <= 150)
                $("#cover").fadeOut(27000);
            else
                $("#cover").fadeOut(40000);
            TotalIdCards = 0;

        }
        else {
            swal('Alert!', 'Please select atleast One Id Card to show preview', 'error'); return;

        }
    }
</script>
