@model HigherEducation.Models.RegistrationPGViewModel

@{
    ViewBag.Title = "PaneltyFee";
    Layout = "~/Views/Shared/_Layout.cshtml";
    //Layout = null;

}
@{
    Session["currentPage"] = 9;

}
@{
    if (Session["MaxPage"] == null)
    {
        Session["currentPage"] = 1;
        Session["MaxPage"] = 1;
    }
    else if (Convert.ToInt32(Session["currentPage"]) > Convert.ToInt32(Session["MaxPage"]))
    {
        Session["MaxPage"] = Session["currentPage"];
    }

}

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fee Pay</title>
<link href="../assets/css/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<link rel="stylesheet" href="~/assets/css/style.css">
<link rel="stylesheet" href="~/assets/css/stylepayment.css">
<link href="~/swalJs/sweetalert.css" rel="stylesheet" />
<link href="~/swalJs/swal-forms.css" rel="stylesheet" />
<link href="~/assets/css/all.css" rel="stylesheet" />
<link href="~/assets/css/jquery-ui.css" rel="stylesheet" />
<script src="~/assets/js/jquery-ui/jquery-ui.min.js"></script>
<style>

    .loader,
    .outer-loader {
        display: inline-block;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0
    }

    .outer-loader {
        background: rgba(0, 0, 0, .3);
        width: 100%;
        height: 100%;
        z-index: 999
    }

    .loader {
        width: 69px;
        height: 89px;
        border: 1px solid #000;
        margin: auto
    }

    .loader-img {
        border: 15px solid #415bbb;
        border-radius: 50%;
        border-top: 15px solid #000;
        width: 80px;
        height: 80px;
        -webkit-animation: spin 1s linear infinite;
        animation: spin 1s linear infinite
    }

    @@-webkit-keyframes spin {
        0% {
            -webkit-transform: rotate(0)
        }

        100% {
            -webkit-transform: rotate(360deg)
        }
    }

    @@keyframes spin {
        0% {
            transform: rotate(0)
        }

        100% {
            transform: rotate(360deg)
        }
    }

    .row_new {
        margin-left: 10px;
        margin-right: 10px
    }

    #logo img {
        height: auto;
        padding-left: 3px;
        width: 40px
    }

    body:not(.menu-on-top).desktop-detected {
        min-height: 907px !important
    }

    .table td {
        padding: 0.35rem;
        white-space: normal;
        word-wrap: break-word;
    }

    .cus-modal .modal-dialog {
        max-width: 800px !important;
    }

    .modal-content .close {
        position: absolute;
        right: -15px;
        background: #E91E63;
        width: 40px;
        height: 40px;
        z-index: 999;
        border-radius: 50%;
        color: #fff;
        font-size: 30px;
        top: -25px;
        cursor: pointer;
    }

    .cus-background .card {
        box-shadow: none !important;
        -webkit-box-shadow: none !important;
        -moz-box-shadow: none !important;
    }

    .cus-inner-data label {
        font-weight: 700 !important;
    }
</style>
<div class="container-fluid top-heading" style="margin-top:1px;">
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-12 cus-heading">
            <h3>Penalty Fee Details</h3>
        </div>
    </div>
</div>

@using (Html.BeginForm("PenaltyFeeRequest", "RegistrationPayment", FormMethod.Post, new { @enctype = "multipart/form-data", onsubmit = "startPreloader();" }))
{

    <div class="row">
        <div class="card c-shadow">
            <div class="card-body">
                <div class="row cus-inner-border">

                    @if (Model.paymentSuccessDetails.Count <= 0)
                    {
                            <div class="col-md-12 form-group text-center">
                                <span style="font-size:16px;font-weight:bold;color:red">If you have already paid fee and payment receipt is not generated, wait for 6 hours.<br>यदि आपने पहले ही शुल्क का भुगतान कर दिया है और भुगतान रसीद उत्पन्न नहीं हुई है, तो 6 घंटे तक प्रतीक्षा करें।</span><br />
                            </div>
                        <div class="col-md-3 b-3">
                            <label for="RegistrationId"><span class="english">Penalty Fee Amount:</span></label>
                        </div>
                        <div class="col-md-3 b-3">
                            @Html.DisplayFor(model => model.amount, new { @class = "form-control input-shadow" })
                        </div>
                        if (Model.amount > 0)
                        {

                            <div class="col-md-3 cus-registerbtn" style="margin-top:5px;">
                                <button class="btn btn-primary" type="submit"><i class="fa fa-credit-card"></i>&nbsp;Pay</button>
                            </div>

                        }
                        else
                        {
                            <div class="col-md-3" style="margin-top:5px;">
                                <input type="button" class="btn btn-success" id="btnSaveMaxPage" value="Next" />
                            </div>
                        }
                    }


                    @if (Model.paymentSuccessDetails.Count > 0)
                    {

                        <div class="row">
                            <div class="col-md-12 form-group">
                                <div class="row" style="margin-top:40px;">
                                    <div class="col-md-12 form-group text-center">
                                        <span style="font-size:16px;font-weight:bold;color:red"><b>Penalty Fee Receipt</b></span>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-hover" id="tblfeedetail" style="box-shadow: 0px 0px 10px 0px #ccc;">
                                        <thead>
                                            <tr>
                                                <th>Amount</th>
                                                <th>Tracking Id</th>
                                                <th>Bank Ref. No.</th>
                                                <th>Order Status</th>
                                                <th>Payment Mode</th>
                                                <th>Payment Date</th>
                                                <th>
                                                    Transaction Id
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in Model.paymentSuccessDetails)
                                            {
                                                <tr>
                                                    <td> @Html.DisplayFor(m => item.Amount, new { @class = "form-control" })</td>
                                                    <td> @Html.DisplayFor(m => item.Tracking_id, new { @class = "form-control" })</td>
                                                    <td> @Html.DisplayFor(m => item.Bank_ref_no, new { @class = "form-control" })</td>
                                                    <td> @Html.DisplayFor(m => item.Order_status, new { @class = "form-control" })</td>
                                                    <td> @Html.DisplayFor(m => item.Payment_mode, new { @class = "form-control" })</td>
                                                    <td> @Html.DisplayFor(m => item.PaymentDate, new { @class = "form-control" })</td>
                                                    <td> @Html.DisplayFor(m => item.Payment_transactionId, new { @class = "form-control" })</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                                <!--<div class="col-md-12 text-center">
                                <a href="@Url.Action("Declaration", "Account")" class="btn btn-info btn-md">Next</a>-->
                                @*<button class="btn btn-primary" id="btnNext" type="submit"><i class="fa fa-credit-card"></i>&nbsp; Next</button>*@
                                <!--</div>-->
                            </div>

                        </div>


                    }
                </div>
            </div>
        </div>
    </div>
}

<div class="outer-loader" style="display: none;">
    <div class="loader-img loader" style="display: none;"></div>
</div>

<script>
    $(document).ready(function () {
          var MaxPages = '@Session["MaxPage"]';
        var currentPage = '@Session["currentPage"]';
        for (var i = 0; i < parseInt(MaxPages) ; i++) {
            if ((i+1) != currentPage) $("#tablist > li:eq(" + i + ")").addClass('done');
            else $("#tablist > li:eq(" + i + ")").addClass('current');
        }
        for (i = 8; i > MaxPages; i--) {
            $("#tablist > li:eq(" + (i - 1) + ")>a").attr("href", "#");
        }


        $('#btnNext').on('click', function () {

            window.location.href = "/Account/Declaration";
        });

        $('#btnSaveMaxPage').on('click', function () {

            SaveMaxPageOnly();
        })

        // disable enter as submit button
        $(window).keydown(function (event) {
            if (event.keyCode == 13) {
                event.preventDefault();
                return false;
            }
        });
    });

     function SaveMaxPageOnly() {
                    $.ajax({
                        type: "POST",
                        contentType: "application/json; charset=utf-8",
                        url: "@Url.Action("SaveMaxPageOnly", "Account")",
                        data: {},
                        dataType: "json",
                        success: function (data) {
                            if (data =="1") {
                             window.location.href = '@Url.Action("Declaration", "Account")';
                            }
                            else {
                                swal("Alert!", "Something went wrong.", "warning");
                            }
                        }
                    });
    }
    function startPreloader() {
        $(".loader").css("display", "block");
        $(".outer-loader").css("display", "block");

    }
    function stopPreloader() {

        $(".loader").css("display", "none");
        $(".outer-loader").css("display", "none");
    }
</script>
